SELECT* FROM DUAL;
CREATE TABLE debtor(
                       id_person NUMERIC GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                       debtor_name VARCHAR2(100) NOT NULL);

CREATE UNIQUE INDEX index_debtor ON maya_zaharieva.debtor(id_name);

CREATE TABLE invoice(
                        id_invoice NUMERIC GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        inovice_number VARCHAR2(10) NOT NULL,
                        invoice_date DATE DEFAULT SYSDATE,
                        invoice_total NUMERIC(38,6) NOT NULL,
                        invoice_currency int NOT NULL,
                        id_person NUMERIC,
                        due_date DATE,
                        CONSTRAINT id_person_rel FOREIGN KEY(id_person)
                            REFERENCES maya_zaharieva.debtor(id_person),
                        CONSTRAINT inv_cur_rel FOREIGN KEY( invoice_currency)
                            REFERENCES maya_zaharieva.currency (id_curr));

SELECT * FROM maya_zaharieva.index_index_invoice;
SELECT * FROM maya_zaharieva.invoice;

-- function to calculate due_date

CREATE UNIQUE INDEX index_invoce ON maya_zaharieva.invoice(inovice_number, due_date);

CREATE TABLE payment(
                        id_payment NUMERIC GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        payment_total NUMERIC(38,6) NOT NULL,
                        payment_currency INT NOT NULL,
                        payment_date DATE DEFAULT SYSDATE,
                        id_invoice NUMERIC ,
                        CONSTRAINT id_invoice_rel FOREIGN KEY(id_invoice)
                        REFERENCES maya_zaharieva.invoice (id_invoice),
                        CONSTRAINT pay_cur_rel FOREIGN KEY( payment_currency)
                                                    REFERENCES maya_zaharieva.currency (id_curr));

CREATE  INDEX index_payment ON maya_zaharieva.payment(id_payment);

CREATE TABLE currency(
  id_curr INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  currency_code VARCHAR2(3),
  currency_name VARCHAR (20) NOT NULL,
  exchange_rate_bgn NUMERIC(38,6) NOT NULL,
  reverse_rate_one_bgn NUMERIC(38,6) NOT NULL);




CREATE OR REPLACE PROCEDURE input_invoice(
inv_num VARCHAR2,
dat DATE,
tot NUMERIC,
cur VARCHAR2,
deb VARCHAR2,
due DATE) AS
begin
INSERT INTO maya_zaharieva.invoice(
   SELECT null, i.inovice_number, i.invoice_date, i.invoice_total,
          c.id_curr, d.debtor_name, i.due_date
   FROM maya_zaharieva.invoice i, maya_zaharieva.debtor d, maya_zaharieva.currency c
   WHERE d.debtor_name LIKE ('%deb%') AND c.currency_code LIKE ('%cur%'));
end;

INSERT INTO "MAYA_ZAHARIEVA"."DEBTOR" (DEBTOR_NAME) VALUES ('stoyan');
INSERT INTO "MAYA_ZAHARIEVA"."DEBTOR" (DEBTOR_NAME) VALUES ('Petar');


INSERT INTO maya_zaharieva.invoice (INOVICE_NUMBER, INVOICE_TOTAL, INVOICE_CURRENCY) VALUES ('0123583000', '23.56', 'lv');

SELECT sys_context( 'userenv', 'current_schema' ) FROM dual;

INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('AUD', 'ралийски долар', '1.25745', '0.79526');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('BRL', 'Бразилски реал', '3.80608', '2.62738');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('CAD', 'Канадски долар', '1.45296', '0.68825');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('CHF', 'Швейцарски франк', '1.98844', '0.502907');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('CNY', 'Китайски ренминби юан', '2.76021', '3.62291');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('CZK', 'Чешка крона', '7.97484', '12.5394');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('DKK', 'Датска крона', '2.62919', '3.80345');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('GBP', 'Британска лира', '2.24143', '0.446144');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('HKD', 'Хонконгски долар', '2.53978', '3.93735');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('HRK', 'Хърватска куна', '2.59556', '3.85273');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('HUF', 'Унгарски форинт', '4.7564', '210.243');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('IDR', 'Индонезийска рупия', '1.28251', '7797.21');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('ILS', 'Израелски шекел', '5.62764', '1.77694');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('INR', 'Индийска рупия', '2.40938', '41.5045');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('ISK', 'Исландска крона', '1.38613', '72.1433');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('JPY', 'Японска йена', '1.33059', '75.1546');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('KRW', 'Южнокорейски вон', '1.39672', '715.963');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('MXN', 'Мексиканско песо', '9.92782', '10.0727');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('MYR', 'Малайзийски рингит', '4.21551', '2.37219');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('NOK', 'Норвежка крона', '1.88024', '5.31847');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('NZD', 'Новозеландски долар', '1.13671', '0.879732');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('PHP', 'Филипинско песо', '3.38719', '29.523');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('PLN', 'Полска злота', '4.09787', '2.44029');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('RON', 'Румънска лея', '3.97502', '2.51571');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('SEK', 'Шведска крона', '1.78094', '5.61501');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('SGD', 'Сингапурски долар', '1.40112', '0.713715');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('THB', 'Тайландски бат', '5.23509', '19.1019');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('TRY', 'Турска лира', '1.07312', '9.31862');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('USD', 'Щатски долар', '1.99351', '0.501628');
INSERT INTO "MAYA_ZAHARIEVA"."CURRENCY" (CURRENCY_CODE, CURRENCY_NAME, EXCHANGE_RATE_BGN, REVERSE_RATE_ONE_BGN) VALUES ('ZAR', 'Южноафрикански ранд', '1.092', '9.15751');




